<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
  <title>Valentine ğŸ’˜</title>

  <style>
    :root{
      --bg1:#ffb3c7;
      --bg2:#ffd6e5;
      --card: rgba(255,255,255,.86);
      --text:#5b0b1a;
      --yes:#e11d48;
      --no:#111827;

      /* dimensiuni responsive */
      --pad: clamp(14px, 3.2vw, 20px);
      --radius: clamp(22px, 5vw, 30px);
      --btnH: clamp(44px, 6.5vh, 54px);
      --btnFont: clamp(16px, 2.3vh, 18px);
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      min-height:100svh; /* iOS friendly */
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background: radial-gradient(circle at top, var(--bg2), var(--bg1));
      overflow:hidden;
      padding: var(--pad);
    }

    .card{
      width: min(620px, 96vw);
      padding: calc(var(--pad) + 6px) var(--pad) var(--pad);
      border-radius: var(--radius);
      background: var(--card);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      box-shadow: 0 25px 70px rgba(0,0,0,.18);
      text-align:center;
      position:relative;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.7);
    }

    h1{
      margin: 0 0 10px;
      font-size: clamp(26px, 5.3vw, 42px);
      letter-spacing:.2px;
    }

    .sub{
      margin: 0 0 14px;
      opacity:.86;
      font-size: clamp(14px, 2.2vw, 15px);
      line-height: 1.45;
    }

    .playground{
      position: relative;
      height: clamp(170px, 26vh, 230px);
      border-radius: clamp(18px, 4.6vw, 22px);
      background: rgba(255,255,255,.35);
      border: 2px dashed rgba(225,29,72,.18);
      overflow:hidden;
    }

    button{
      border:0;
      height: var(--btnH);
      padding: 0 clamp(18px, 4.5vw, 24px);
      border-radius: 999px;
      font-size: var(--btnFont);
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      box-shadow: 0 10px 25px rgba(0,0,0,.14);
      will-change: transform, left, top;
      white-space: nowrap;
    }

    #yes{
      background: var(--yes);
      color:white;
      position:absolute;
      left: 10px;
      top: 12px;
      transform-origin: center center;
      z-index: 3;
    }

    #no{
      background: white;
      color: var(--no);
      position:absolute;
      left: 10px;
      top: 12px;
      z-index: 3;
      touch-action: none; /* important pe iPhone */
    }

    .note{
      margin-top: 14px;
      display:flex;
      justify-content:center;
      min-height: clamp(56px, 9vh, 70px);
    }

    .noteBubble{
      padding: 12px 16px;
      border-radius: 22px;
      background: linear-gradient(to right, rgba(255,255,255,.92), rgba(255,240,245,.92));
      border: 1px solid rgba(225,29,72,.18);
      box-shadow: 0 12px 30px rgba(0,0,0,.08);
      font-size: clamp(14px, 2.2vw, 15px);
      color: #7a0d22;
      line-height: 1.4;
      max-width: 520px;
      opacity: 1;
      transition: opacity .22s ease, transform .22s ease;
    }
    .noteBubble.fadeOut{
      opacity: 0;
      transform: translateY(2px);
    }
    .noteBubble b{ color:#e11d48; }

    /* inimioare */
    .heart{
      position:absolute;
      width:14px; height:14px;
      transform: rotate(45deg);
      opacity:.85;
      animation: fall linear forwards;
      pointer-events:none;
      filter: blur(.2px);
      z-index:0;
    }
    .heart::before,.heart::after{
      content:"";
      position:absolute;
      width:14px; height:14px;
      border-radius:50%;
      background: currentColor;
    }
    .heart{ background: currentColor; }
    .heart::before{ left:-7px; top:0; }
    .heart::after{ left:0; top:-7px; }
    @keyframes fall{
      from{ transform:translateY(-20px) rotate(45deg); }
      to{ transform:translateY(110svh) rotate(45deg); }
    }

    /* overlay */
    .overlay{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,.55);
      z-index:50;
      padding: var(--pad);
    }
    .overlay.show{ display:flex; }

    .videoBox{
      width: min(900px, 96vw);
      border-radius: 22px;
      overflow:hidden;
      background:#000;
      position:relative;
      box-shadow: 0 30px 90px rgba(0,0,0,.45);
    }

    video{
      width:100%;
      height:auto;
      display:block;
      background:#000;
    }

    .surpriseCard{
      position:absolute;
      top: 12px;
      left: 12px;
      right: 12px;
      margin:auto;
      max-width: 560px;
      padding: 14px 14px;
      border-radius: 22px;
      background: rgba(255,255,255,.92);
      color: #7a0d22;
      text-align:center;
      opacity:0;
      transform: translateY(-8px) scale(.98);
      transition: opacity .6s ease, transform .6s cubic-bezier(.2,1,.2,1);
      border: 1px solid rgba(225,29,72,.18);
      pointer-events:none;
      line-height:1.35;
    }
    .surpriseCard b{ color:#e11d48; }
    .surpriseCard.show{ opacity:1; transform: translateY(0) scale(1); }

    .msg{
      position:absolute;
      bottom:0;
      left:0;
      right:0;
      padding:14px;
      text-align:center;
      color:white;
      background: linear-gradient(to top, rgba(0,0,0,.8), transparent);
    }

    @media (prefers-reduced-motion: reduce){
      .heart{ animation: none; display:none; }
      .noteBubble{ transition:none; }
      .surpriseCard{ transition:none; }
    }
  </style>
</head>

<body>

  <div class="card">
    <h1>Vrei sÄƒ fii Valentinul meu? ğŸ’–</h1>
    <p class="sub">Promit zÃ¢mbete, Ã®mbrÄƒÈ›iÈ™Äƒri È™i o surprizÄƒ dupÄƒ ce alegiâ€¦ ğŸ˜„</p>

    <div class="playground" id="playground">
      <button id="yes">Da ğŸ˜</button>
      <button id="no">Nu ğŸ˜¢</button>
    </div>

    <div class="note">
      <div class="noteBubble" id="noteBubble">ÃncearcÄƒ sÄƒ alegiâ€¦ ğŸ˜Š</div>
    </div>
  </div>

  <div class="overlay" id="overlay">
    <div class="videoBox">
      <div class="surpriseCard" id="surpriseCard">
        ğŸ’Œ Pe <b>14 februarie</b> te aÈ™teaptÄƒ o surprizÄƒ...<br>
        DÄƒ-mi adresa ta È™i Ã®È›i trimit un zÃ¢mbet Ã®n plus â¤ï¸
      </div>

      <video id="fwVideo" playsinline controls>
        <source src="fireworks.webm" type="video/webm">
        <source src="https://upload.wikimedia.org/wikipedia/commons/9/9d/Fireworks_-_Super_Slow_Motion_%28Free_to_Use_Stock_Video_Footage%29.webm">
      </video>

      <div class="msg">
        <h2 style="margin:0 0 6px 0; font-size:clamp(18px,3.3vw,26px);">Yaaay! ğŸ’˜</h2>
        <p style="margin:0; opacity:.92;">Te iubesc mult! MulÈ›umesc cÄƒ eÈ™ti tu â¤ï¸</p>
      </div>
    </div>
  </div>

  <script>
    const yesBtn = document.getElementById("yes");
    const noBtn  = document.getElementById("no");
    const overlay= document.getElementById("overlay");
    const video  = document.getElementById("fwVideo");
    const playground = document.getElementById("playground");
    const noteBubble = document.getElementById("noteBubble");
    const surpriseCard = document.getElementById("surpriseCard");

    // inimioare (mai light pe mobil)
    function spawnHeart(){
      const h=document.createElement("div");
      h.className="heart";
      h.style.left=(Math.random()*100)+"vw";
      h.style.top="-20px";
      h.style.animationDuration=(3.2+Math.random()*3.2)+"s";
      h.style.color=(Math.random()>0.5) ? "#e11d48" : "#fb7185";
      h.style.opacity=(0.55+Math.random()*0.35).toFixed(2);
      document.body.appendChild(h);
      setTimeout(()=>h.remove(),7000);
    }
    setInterval(spawnHeart, 280);

    // Ã®ntrebÄƒri
    let dodges = 0;
    const maxDodges = 15;

    const questions = [
      "DacÄƒ È›i-aÈ™ aduce ciocolatÄƒ acumâ€¦ ai zice â€Daâ€? ğŸ«",
      "Pot sÄƒ-È›i fur un zÃ¢mbet azi? ğŸ˜Š",
      "Vrei sÄƒ fii motivul meu de fericire? âœ¨",
      "Ne facem o amintire frumoasÄƒ Ã®mpreunÄƒ? ğŸ’",
      "ÃÈ›i place ideea de o searÄƒ doar noi doi? ğŸ•¯ï¸",
      "DacÄƒ Ã®È›i spun cÄƒ te apreciez multâ€¦ mÄƒ crezi? ğŸ¥º",
      "ÃÈ›i pot promite Ã®mbrÄƒÈ›iÈ™Äƒri nelimitate? ğŸ«¶",
      "Vrei sÄƒ fii persoana mea preferatÄƒ oficial? ğŸ˜„",
      "Ne dÄƒm Ã®ntÃ¢lnire cu zÃ¢mbete È™i voie bunÄƒ? ğŸ˜",
      "ÃÈ›i place cÃ¢nd Ã®È›i spun cÃ¢t de specialÄƒ eÈ™ti? ğŸ’—",
      "Pot sÄƒ-È›i spun un secret? Te aleg pe tine â¤ï¸",
      "Vrei sÄƒ-È›i fac ziua mai dulce? ğŸ°",
      "DacÄƒ aÈ™ putea, aÈ™ opri timpul la un moment cu noiâ€¦ â³",
      "Mai Ã®ncerc o datÄƒâ€¦ spui â€Daâ€? ğŸ¥°",
      "Ultima Ã®ntrebareâ€¦ vrei sÄƒ fii Valentinul meu? ğŸ’˜"
    ];

    function setMessage(html){
      noteBubble.classList.add("fadeOut");
      setTimeout(()=>{
        noteBubble.innerHTML = html;
        noteBubble.classList.remove("fadeOut");
      }, 170);
    }

    function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }
    function rectCenter(r){ return { x: r.left + r.width/2, y: r.top + r.height/2 }; }
    function dist(a,b){ return Math.hypot(a.x-b.x, a.y-b.y); }

    // poziÈ›ionare iniÈ›ialÄƒ proporÈ›ionalÄƒ (fÄƒrÄƒ translate fix)
    function layoutInitialButtons(){
      const area = playground.getBoundingClientRect();
      // lÄƒsÄƒm puÈ›in padding
      const pad = 10;

      // mÄƒsurÄƒm butoanele
      const yesR = yesBtn.getBoundingClientRect();
      const noR  = noBtn.getBoundingClientRect();

      // yes la ~25% din lÄƒÈ›ime, no la ~70%
      const yesX = clamp(area.width * 0.22 - yesR.width/2, pad, area.width - yesR.width - pad);
      const noX  = clamp(area.width * 0.72 - noR.width/2, pad, area.width - noR.width  - pad);

      const y = pad + 6;

      yesBtn.style.left = yesX + "px";
      yesBtn.style.top  = y + "px";
      // reset transform (scale vine separat)
      yesBtn.style.transform = "scale(1)";

      noBtn.style.left = noX + "px";
      noBtn.style.top  = y + "px";
      noBtn.style.transform = "translateX(0)";
    }

    // â€Daâ€ creÈ™te mai mult (8% per dodge, max +120%)
    function growYes(){
      const scale = 1 + Math.min(dodges * 0.08, 1.20);
      yesBtn.style.transform = `scale(${scale.toFixed(3)})`;
    }

    function pickSafePosition(){
      const area = playground.getBoundingClientRect();
      const yesR = yesBtn.getBoundingClientRect();
      const noR  = noBtn.getBoundingClientRect();

      const pad = 10;
      const maxX = area.width  - noR.width  - pad;
      const maxY = area.height - noR.height - pad;

      // distanÈ›Äƒ minimÄƒ faÈ›Äƒ de â€Daâ€ (creÈ™te odatÄƒ cu mÄƒrimea lui â€Daâ€)
      const minDistance = 140 + Math.min(dodges * 14, 220);

      const yesCenter = rectCenter(yesR);

      // Ã®ncercÄƒm sÄƒ gÄƒsim poziÈ›ie bunÄƒ
      for (let i = 0; i < 80; i++){
        const x = Math.random() * maxX + pad;
        const y = Math.random() * maxY + pad;

        const testRect = {
          left: area.left + x,
          top:  area.top  + y,
          width: noR.width,
          height: noR.height
        };
        const noCenter = rectCenter(testRect);

        // pÄƒstrÄƒm È™i o zonÄƒ â€œsafeâ€ sÄƒ nu ajungÄƒ foarte sus lÃ¢ngÄƒ â€Daâ€
        const notTooTop = (y > (pad + 4)) || (dodges < 2);

        if (notTooTop && dist(yesCenter, noCenter) >= minDistance) {
          return { x, y };
        }
      }

      // fallback: jos stÃ¢nga/dreapta
      return { x: pad, y: maxY };
    }

    function moveNoButton(){
      if (dodges >= maxDodges) return;

      setMessage(questions[dodges]);
      growYes();

      const pos = pickSafePosition();
      noBtn.style.left = pos.x + "px";
      noBtn.style.top  = pos.y + "px";

      dodges++;

      if (dodges >= maxDodges){
        setMessage("ğŸ’Œ Pe <b>14 februarie</b> te aÈ™teaptÄƒ o surprizÄƒ... â¤ï¸");
      }
    }

    // iPhone: touchstart e cel mai stabil. Punem capture + passive:false.
    function dodgeNow(e){
      if (dodges >= maxDodges) return;
      e.preventDefault();
      e.stopPropagation();
      // mutÄƒm imediat (Ã®n acelaÈ™i frame)
      requestAnimationFrame(moveNoButton);
    }

    noBtn.addEventListener("touchstart", dodgeNow, { passive: false, capture: true });
    noBtn.addEventListener("pointerdown", dodgeNow, { capture: true });

    // â€Daâ€
    yesBtn.addEventListener("click", async () => {
      overlay.classList.add("show");
      surpriseCard.classList.add("show");
      try{
        video.currentTime = 0;
        await video.play();
      }catch(e){}
    });

    overlay.addEventListener("click", (e) => {
      if (e.target === overlay){
        video.pause();
        overlay.classList.remove("show");
        surpriseCard.classList.remove("show");
      }
    });

    // la load / resize / rotate: recalculÄƒm proporÈ›ional
    function relayout(){
      // re-aÈ™ezÄƒm butoanele proporÈ›ional
      layoutInitialButtons();
      // reaplicÄƒm scale-ul curent pe Da
      growYes();
      // dupÄƒ relayout, mutÄƒm Nu Ã®ntr-o poziÈ›ie sigurÄƒ (ca sÄƒ nu pice lÃ¢ngÄƒ Da)
      const pos = pickSafePosition();
      noBtn.style.left = pos.x + "px";
      noBtn.style.top  = pos.y + "px";
    }

    window.addEventListener("resize", () => requestAnimationFrame(relayout));
    window.addEventListener("orientationchange", () => setTimeout(relayout, 60));

    // start
    relayout();
  </script>

</body>
</html>
