<!doctype html>
<html lang="ro">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
    <title>Valentine 💘</title>

    <style>
        :root {
            --bg1: #ffb3c7;
            --bg2: #ffd6e5;
            --card: #ffffffd9;
            --text: #5b0b1a;
            --yes: #e11d48;
            --no: #111827;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
            color: var(--text);
            background: radial-gradient(circle at top, var(--bg2), var(--bg1));
            overflow: hidden;
            padding: 18px;
        }

        .card {
            width: min(560px, 94vw);
            padding: 30px 20px 20px;
            border-radius: 30px;
            background: var(--card);
            backdrop-filter: blur(14px);
            -webkit-backdrop-filter: blur(14px);
            box-shadow: 0 25px 70px rgba(0,0,0,.18);
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,.65);
        }

        h1 {
            margin: 0 0 10px;
            font-size: clamp(26px, 6vw, 42px);
        }

        .sub {
            margin: 0 0 16px;
            opacity: .85;
            font-size: 15px;
            line-height: 1.45;
        }

        .playground {
            position: relative;
            height: 200px;
            border-radius: 20px;
            background: rgba(255,255,255,.35);
            border: 2px dashed rgba(225,29,72,.18);
            overflow: hidden;
        }

        button {
            border: 0;
            border-radius: 999px;
            padding: 14px 22px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(0,0,0,.14);
            transition: transform .15s ease, filter .15s ease;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            will-change: transform, left, top;
        }

            button:active {
                transform: scale(.96);
            }

        #yes {
            background: var(--yes);
            color: white;
            min-width: 150px;
            position: absolute;
            left: 50%;
            top: 16px;
            transform: translateX(-125px);
            z-index: 2;
        }

        #no {
            background: white;
            color: var(--no);
            min-width: 150px;
            position: absolute;
            left: 50%;
            top: 16px;
            transform: translateX(18px);
            z-index: 2;
            touch-action: none; /* IMPORTANT pt iPhone */
        }

        .note {
            margin-top: 14px;
            display: flex;
            justify-content: center;
            min-height: 64px;
        }

        .noteBubble {
            padding: 12px 16px;
            border-radius: 22px;
            background: linear-gradient(to right, rgba(255,255,255,.9), rgba(255,240,245,.9));
            border: 1px solid rgba(225,29,72,.18);
            box-shadow: 0 12px 30px rgba(0,0,0,.08);
            font-size: 15px;
            color: #7a0d22;
            line-height: 1.4;
            max-width: 460px;
            opacity: 1;
            transition: opacity .25s ease;
        }

            .noteBubble.fadeOut {
                opacity: 0;
            }

            .noteBubble b {
                color: #e11d48;
            }

        /* inimioare */
        .heart {
            position: absolute;
            width: 14px;
            height: 14px;
            transform: rotate(45deg);
            opacity: .85;
            animation: fall linear forwards;
            pointer-events: none;
            filter: blur(.2px);
            z-index: 0;
        }

            .heart::before, .heart::after {
                content: "";
                position: absolute;
                width: 14px;
                height: 14px;
                border-radius: 50%;
                background: currentColor;
            }

        .heart {
            background: currentColor;
        }

            .heart::before {
                left: -7px;
                top: 0;
            }

            .heart::after {
                left: 0;
                top: -7px;
            }

        @keyframes fall {
            from {
                transform: translateY(-20px) rotate(45deg);
            }

            to {
                transform: translateY(110vh) rotate(45deg);
            }
        }

        /* overlay */
        .overlay {
            position: fixed;
            inset: 0;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,.55);
            z-index: 50;
            padding: 14px;
        }

            .overlay.show {
                display: flex;
            }

        .videoBox {
            width: min(900px, 96vw);
            border-radius: 22px;
            overflow: hidden;
            background: #000;
            position: relative;
            box-shadow: 0 30px 90px rgba(0,0,0,.45);
        }

        video {
            width: 100%;
            height: auto;
            display: block;
            background: #000;
        }

        .surpriseCard {
            position: absolute;
            top: 14px;
            left: 14px;
            right: 14px;
            margin: auto;
            max-width: 520px;
            padding: 14px;
            border-radius: 22px;
            background: rgba(255,255,255,.92);
            color: #7a0d22;
            text-align: center;
            opacity: 0;
            transform: translateY(-8px) scale(.98);
            transition: opacity .6s ease, transform .6s cubic-bezier(.2,1,.2,1);
            border: 1px solid rgba(225,29,72,.18);
            pointer-events: none;
        }

            .surpriseCard b {
                color: #e11d48;
            }

            .surpriseCard.show {
                opacity: 1;
                transform: translateY(0) scale(1);
            }

        .msg {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 14px;
            text-align: center;
            color: white;
            background: linear-gradient(to top, rgba(0,0,0,.8), transparent);
        }

        @media(max-width:420px) {
            #yes, #no {
                min-width: 140px;
            }

            .playground {
                height: 215px;
            }
        }
    </style>
</head>

<body>

    <div class="card">
        <h1>Vrei să fii Valentinul meu? 💖</h1>
        <p class="sub">Promit zâmbete, îmbrățișări și o surpriză după ce alegi… 😄</p>

        <div class="playground" id="playground">
            <button id="yes">Da 😍</button>
            <button id="no">Nu 😢</button>
        </div>

        <div class="note">
            <div class="noteBubble" id="noteBubble">
                Încearcă să alegi… 😊
            </div>
        </div>
    </div>

    <div class="overlay" id="overlay">
        <div class="videoBox">
            <div class="surpriseCard" id="surpriseCard">
                💌 Pe <b>14 februarie</b> te așteaptă o surpriză...<br>
                Dă-mi adresa ta și îți trimit un zâmbet în plus ❤️
            </div>

            <video id="fwVideo" playsinline controls>
                <source src="fireworks.webm" type="video/webm">
                <source src="https://upload.wikimedia.org/wikipedia/commons/9/9d/Fireworks_-_Super_Slow_Motion_%28Free_to_Use_Stock_Video_Footage%29.webm">
            </video>

            <div class="msg">
                <h2>Yaaay! 💘</h2>
                <p>Te iubesc mult! Mulțumesc că ești tu ❤️</p>
            </div>
        </div>
    </div>

    <script>
        const yesBtn = document.getElementById("yes");
        const noBtn = document.getElementById("no");
        const overlay = document.getElementById("overlay");
        const video = document.getElementById("fwVideo");
        const playground = document.getElementById("playground");
        const noteBubble = document.getElementById("noteBubble");
        const surpriseCard = document.getElementById("surpriseCard");

        // inimioare
        function spawnHeart() {
            const h = document.createElement("div");
            h.className = "heart";
            h.style.left = Math.random() * 100 + "vw";
            h.style.top = "-20px";
            h.style.animationDuration = (3 + Math.random() * 3) + "s";
            h.style.color = Math.random() > 0.5 ? "#e11d48" : "#fb7185";
            h.style.opacity = (0.55 + Math.random() * 0.35).toFixed(2);
            document.body.appendChild(h);
            setTimeout(() => h.remove(), 6500);
        }
        setInterval(spawnHeart, 250);

        // întrebări
        let dodges = 0;
        const maxDodges = 15;

        const questions = [
            "Dacă ți-aș aduce ciocolată acum… ai zice „Da”? 🍫",
            "Pot să-ți fur un zâmbet azi? 😊",
            "Vrei să fii motivul meu de fericire? ✨",
            "Ne facem o amintire frumoasă împreună? 💞",
            "Îți place ideea de o seară doar noi doi? 🕯️",
            "Dacă îți spun că te apreciez mult… mă crezi? 🥺",
            "Îți pot promite îmbrățișări nelimitate? 🫶",
            "Vrei să fii persoana mea preferată oficial? 😄",
            "Ne dăm întâlnire cu zâmbete și voie bună? 😍",
            "Îți place când îți spun cât de specială ești? 💗",
            "Pot să-ți spun un secret? Te aleg pe tine ❤️",
            "Vrei să-ți fac ziua mai dulce? 🍰",
            "Dacă aș putea, aș opri timpul la un moment cu noi… ⏳",
            "Mai încerc o dată… spui „Da”? 🥰",
            "Ultima întrebare… vrei să fii Valentinul meu? 💘"
        ];

        function setMessage(html) {
            noteBubble.classList.add("fadeOut");
            setTimeout(() => {
                noteBubble.innerHTML = html;
                noteBubble.classList.remove("fadeOut");
            }, 180);
        }

        function getYesBaseTranslateX() {
            return window.matchMedia("(max-width: 420px)").matches ? -118 : -125;
        }

        function growYes() {
            // ✅ mult mai mare: 8% per încercare, max +120% (aproape 2.2x)
            const scale = 1 + Math.min(dodges * 0.08, 1.20);
            const tx = getYesBaseTranslateX();
            yesBtn.style.transform = `translateX(${tx}px) scale(${scale.toFixed(3)})`;
        }

        function clamp(v, min, max) { return Math.max(min, Math.min(max, v)); }
        function rectCenter(r) { return { x: r.left + r.width / 2, y: r.top + r.height / 2 }; }
        function dist(a, b) { return Math.hypot(a.x - b.x, a.y - b.y); }

        function pickSafePosition() {
            const area = playground.getBoundingClientRect();
            const yesR = yesBtn.getBoundingClientRect();
            const noR = noBtn.getBoundingClientRect();

            const pad = 10;
            const maxX = area.width - noR.width - pad;
            const maxY = area.height - noR.height - pad;

            // distanță minimă față de „Da” (crește și ea, ca să nu se apropie)
            const minDistance = 130 + Math.min(dodges * 10, 160);

            const yesCenter = rectCenter(yesR);

            for (let i = 0; i < 60; i++) {
                const x = Math.random() * maxX + pad;
                const y = Math.random() * maxY + pad;

                const testRect = {
                    left: area.left + x,
                    top: area.top + y,
                    width: noR.width,
                    height: noR.height
                };

                const noCenter = rectCenter(testRect);
                if (dist(yesCenter, noCenter) >= minDistance) return { x, y };
            }

            // fallback
            return { x: pad, y: maxY };
        }

        function moveNoButton() {
            if (dodges >= maxDodges) return;

            setMessage(questions[dodges]);
            growYes();

            const pos = pickSafePosition();
            noBtn.style.left = pos.x + "px";
            noBtn.style.top = pos.y + "px";
            noBtn.style.transform = "translateX(0)";

            dodges++;

            if (dodges >= maxDodges) {
                setMessage("💌 Pe <b>14 februarie</b> te așteaptă o surpriză... ❤️");
            }
        }

        // ✅ iPhone: touchstart e cel mai stabil
        function dodgeNow(e) {
            if (dodges >= maxDodges) return;
            e.preventDefault();
            e.stopPropagation();
            moveNoButton();
        }

        noBtn.addEventListener("touchstart", dodgeNow, { passive: false });
        noBtn.addEventListener("pointerdown", dodgeNow);

        // (mouse hover doar pe desktop)
        noBtn.addEventListener("mouseenter", (e) => {
            if (!("ontouchstart" in window) && dodges < maxDodges) moveNoButton();
        });

        yesBtn.addEventListener("click", async () => {
            overlay.classList.add("show");
            surpriseCard.classList.add("show");
            try {
                video.currentTime = 0;
                await video.play();
            } catch (e) { }
        });

        overlay.addEventListener("click", (e) => {
            if (e.target === overlay) {
                video.pause();
                overlay.classList.remove("show");
                surpriseCard.classList.remove("show");
            }
        });

        window.addEventListener("resize", () => {
            growYes();
            noBtn.style.left = "50%";
            noBtn.style.top = "16px";
            noBtn.style.transform = "translateX(18px)";
        });
    </script>

</body>
</html>
